{
  "extractors": [
    {
      "title": "Wazuh JSON Extractor",
      "extractor_type": "json",
      "converters": [],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "message",
      "target_field": "",
      "extractor_config": {
        "list_separator": ", ",
        "kv_separator": ":",
        "key_prefix": "",
        "key_separator": "_",
        "replace_key_whitespace": false,
        "key_whitespace_replacement": "_"
      },
      "condition_type": "none",
      "condition_value": ""
    },
    {
      "title": "Rule Group 01",
      "extractor_type": "split_and_index",
      "converters": [],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "rule_groups",
      "target_field": "rule_group_01",
      "extractor_config": {
        "index": 1,
        "split_by": ","
      },
      "condition_type": "none",
      "condition_value": ""
    },
    {
      "title": "Rule Group 02",
      "extractor_type": "split_and_index",
      "converters": [],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "rule_groups",
      "target_field": "rule_group_02",
      "extractor_config": {
        "index": 2,
        "split_by": ","
      },
      "condition_type": "none",
      "condition_value": ""
    },
    {
      "title": "Rule Group 03",
      "extractor_type": "split_and_index",
      "converters": [],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "rule_groups",
      "target_field": "rule_group_03",
      "extractor_config": {
        "index": 3,
        "split_by": ","
      },
      "condition_type": "none",
      "condition_value": ""
    },
    {
      "title": "Windows Detender - Extract Malware Location",
      "extractor_type": "grok",
      "converters": [],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "data_win_system_message",
      "target_field": "",
      "extractor_config": {
        "grok_pattern": "Path: %{GREEDYDATA:malware_path}"
      },
      "condition_type": "string",
      "condition_value": "Microsoft Defender Antivirus has taken action to protect this machine from malware or other potentially unwanted software."
    },
    {
      "title": "Windows Detender - Extract Malware Action Taken",
      "extractor_type": "grok",
      "converters": [],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "data_win_system_message",
      "target_field": "",
      "extractor_config": {
        "grok_pattern": "Action: %{GREEDYDATA:malware_action_taken}"
      },
      "condition_type": "string",
      "condition_value": "Microsoft Defender Antivirus has taken action to protect this machine from malware or other potentially unwanted software."
    },
    {
      "title": "Windows Detender - Extract Malware Name",
      "extractor_type": "grok",
      "converters": [],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "data_win_system_message",
      "target_field": "",
      "extractor_config": {
        "grok_pattern": "Name: %{GREEDYDATA:malware_detected}"
      },
      "condition_type": "string",
      "condition_value": "Microsoft Defender Antivirus has taken action to protect this machine from malware or other potentially unwanted software."
    },
    {
      "title": "Windows Detender - Extract Malware Category",
      "extractor_type": "grok",
      "converters": [],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "data_win_system_message",
      "target_field": "",
      "extractor_config": {
        "grok_pattern": "Category: %{GREEDYDATA: malware_category}"
      },
      "condition_type": "string",
      "condition_value": "Microsoft Defender Antivirus has taken action to protect this machine from malware or other potentially unwanted software."
    },
    {
      "title": "Yara - Extract Malware Name",
      "extractor_type": "grok",
      "converters": [],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "data_yara_rule",
      "target_field": "",
      "extractor_config": {
        "grok_pattern": "%{GREEDYDATA:malware_detected}"
      },
      "condition_type": "none",
      "condition_value": ""
    },
    {
      "title": "Yara - Malware Path",
      "extractor_type": "copy_input",
      "converters": [],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "data_yara_scanned_file",
      "target_field": "malware_path",
      "extractor_config": {},
      "condition_type": "none",
      "condition_value": ""
    },
    {
      "title": "Windows Defender - Extract Malware Action Result ",
      "extractor_type": "grok",
      "converters": [],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "data_win_system_message",
      "target_field": "",
      "extractor_config": {
        "grok_pattern": "Error description: %{GREEDYDATA:malware_action_taken_result}"
      },
      "condition_type": "string",
      "condition_value": "Microsoft Defender Antivirus has taken action to protect this machine from malware or other potentially unwanted software."
    },
    {
      "title": "Yara - Extract Malware Path",
      "extractor_type": "split_and_index",
      "converters": [],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "data_eventdata_commandLine",
      "target_field": "malware_action_taken",
      "extractor_config": {
        "index": 2,
        "split_by": ":"
      },
      "condition_type": "string",
      "condition_value": "/usr/bin/echo wazuh-yara:"
    },
    {
      "title": "Create timestamp_utc field",
      "extractor_type": "copy_input",
      "converters": [
        {
          "type": "date",
          "config": {
            "date_format": "yyyy-MM-dd HH-mm-ss.SSS",
            "time_zone": "Etc/UTC"
          }
        }
      ],
      "order": 0,
      "cursor_strategy": "copy",
      "source_field": "timestamp",
      "target_field": "timestamp_utc",
      "extractor_config": {},
      "condition_type": "none",
      "condition_value": ""
    }
  ],
  "version": "5.1.10"
}